CREATE TABLE hits ( my_date DATE, ip_address CHAR(15));

insert into hits values ('2009-01-01','999.999.999.999');
insert into hits values ('2009-01-02','999.999.999.999');
insert into hits values ('2009-01-03','999.999.999.999');
insert into hits values ('2009-01-04','999.999.999.999');
insert into hits values ('2009-01-05','999.999.999.999');
insert into hits values ('2009-01-06','999.999.999.999');
insert into hits values ('2009-01-07','999.999.999.999');
insert into hits values ('2009-01-08','999.999.999.999');
insert into hits values ('2009-01-09','999.999.999.999');
insert into hits values ('2009-01-10','999.999.999.998');
insert into hits values ('2009-01-11','999.999.999.998');
insert into hits values ('2009-01-12','999.999.999.998');
insert into hits values ('2009-01-13','999.999.999.998');
insert into hits values ('2009-01-14','999.999.999.998');
insert into hits values ('2009-01-15','999.999.999.998');
insert into hits values ('2009-01-16','999.999.999.997');
insert into hits values ('2009-01-17','999.999.999.997');
insert into hits values ('2009-01-18','999.999.999.997');
insert into hits values ('2009-01-19','999.999.999.997');
insert into hits values ('2009-01-20','999.999.999.997');
insert into hits values ('2009-01-21','999.999.999.996');
insert into hits values ('2009-01-22','999.999.999.996');
insert into hits values ('2009-01-23','999.999.999.996');
insert into hits values ('2009-01-24','999.999.999.996');
insert into hits values ('2009-01-25','999.999.999.995');
insert into hits values ('2009-01-26','999.999.999.995');
insert into hits values ('2009-01-27','999.999.999.995');
insert into hits values ('2009-01-30','999.999.999.994');
insert into hits values ('2009-01-31','999.999.999.994');


insert into hits values ('2009-02-01','999.999.999.997');
insert into hits values ('2009-02-02','999.999.999.997');
insert into hits values ('2009-02-03','999.999.999.997');
insert into hits values ('2009-02-04','999.999.999.997');
insert into hits values ('2009-02-05','999.999.999.997');
insert into hits values ('2009-02-06','999.999.999.997');
insert into hits values ('2009-02-07','999.999.999.997');
insert into hits values ('2009-02-08','999.999.999.997');
insert into hits values ('2009-02-09','999.999.999.996');
insert into hits values ('2009-02-10','999.999.999.996');
insert into hits values ('2009-02-11','999.999.999.996');
insert into hits values ('2009-02-12','999.999.999.996');
insert into hits values ('2009-02-13','999.999.999.996');
insert into hits values ('2009-02-14','999.999.999.996');
insert into hits values ('2009-02-15','999.999.999.995');
insert into hits values ('2009-02-16','999.999.999.995');
insert into hits values ('2009-02-17','999.999.999.995');
insert into hits values ('2009-02-18','999.999.999.995');
insert into hits values ('2009-02-19','999.999.999.995');
insert into hits values ('2009-02-20','999.999.999.994');
insert into hits values ('2009-02-21','999.999.999.994');
insert into hits values ('2009-02-22','999.999.999.994');
insert into hits values ('2009-02-23','999.999.999.994');
insert into hits values ('2009-02-24','999.999.999.993');
insert into hits values ('2009-02-25','999.999.999.993');
insert into hits values ('2009-02-26','999.999.999.993');
insert into hits values ('2009-02-27','999.999.999.992');
insert into hits values ('2009-02-28','999.999.999.992');

insert into hits values ('2009-03-01','999.999.999.997');
insert into hits values ('2009-03-02','999.999.999.997');
insert into hits values ('2009-03-03','999.999.999.997');
insert into hits values ('2009-03-04','999.999.999.997');
insert into hits values ('2009-03-05','999.999.999.997');
insert into hits values ('2009-03-06','999.999.999.997');
insert into hits values ('2009-03-07','999.999.999.997');
insert into hits values ('2009-03-08','999.999.999.997');
insert into hits values ('2009-03-09','999.999.999.996');
insert into hits values ('2009-03-10','999.999.999.996');
insert into hits values ('2009-03-11','999.999.999.996');
insert into hits values ('2009-03-12','999.999.999.996');
insert into hits values ('2009-03-13','999.999.999.996');
insert into hits values ('2009-03-14','999.999.999.996');
insert into hits values ('2009-03-15','999.999.999.996');
insert into hits values ('2009-03-16','999.999.999.996');
insert into hits values ('2009-03-17','999.999.999.996');
insert into hits values ('2009-03-18','999.999.999.996');
insert into hits values ('2009-03-19','999.999.999.996');
insert into hits values ('2009-03-20','999.999.999.996');
insert into hits values ('2009-03-21','999.999.999.995');
insert into hits values ('2009-03-22','999.999.999.995');
insert into hits values ('2009-03-23','999.999.999.995');
insert into hits values ('2009-03-24','999.999.999.995');
insert into hits values ('2009-03-25','999.999.999.995');
insert into hits values ('2009-03-26','999.999.999.994');
insert into hits values ('2009-03-27','999.999.999.994');
insert into hits values ('2009-03-28','999.999.999.994');
insert into hits values ('2009-03-29','999.999.999.994');
insert into hits values ('2009-03-30','999.999.999.993');
insert into hits values ('2009-03-31','999.999.999.992');
insert into hits values ('2009-03-31','999.999.999.992');

CREATE VIEW monthly_hits(month,ip_address,hits) as
 SELECT month(my_date), ip_address,
   COUNT(*)
 FROM hits
 GROUP BY month(my_date),ip_address;
